## 2022.6

为了尽可能地还原原游戏，我们需要一些手段获取到原游戏 swf 文件及其信息，方法就是使用软件 Flash Decompiler Trillix。然后我们就面临着一个严重的问题：这些素材需要我们自己拼接这就是最麻烦的地方。当然，我们也有自己的解决办法，我们可以写一个动画生成工具，当然现在还不需要。现在我们完全可以拿一张 png 格式的图片来暂时替代图片。

为了提高游戏体验，我们可以将游戏画面尽可能地做大，熟悉前端的朋友们应该意识到了，flex 布局是最佳选择。我们先搞一个 div，然后加上一些简单的 css 效果。这里我们使用 less 作为 style 语言。我们简单地写一下让游戏居中显示。

![1](./images/stage1/1.png)

然后我们需要测量游戏画面的长宽比（吐槽一下国产浏览器太慢了），经过测量，长宽比为 16:9，那么我们可以监听页面的 resize 事件，实时让游戏画面尽可能大地显示

## 2023.2.7

下面我们需要获取游戏的图片等信息，需要用到 Flash Decompiler Trillix 对游戏的 swf 文件反编译。在支持 flash 的浏览器中，我们可以按下 F12 打开浏览器的控制台，然后选择网络，监听网络活动，然后在筛选器中输入 swf，筛选出所有的 swf 文件

![2](./images/stage1/image.png)

## 加载

首先是写一个加载界面。我们将 TDLoaderUI.swf 下载下来并提取，会发现加载界面的所有的文字都是图片，这就给我们显示文字带来了很大的难度。但好在其他的地方都是可以通过图片的相互堆叠来实现。在控制台获取加载界面的背景图 loadingbg.jpg，然后使用 ai 高清修复图片高清化一下。下面我们就可以搭一个加载界面出来了。我们先来明确一下制作加载界面的步骤：

1. 绘制背景图
2. 绘制进度条
3. 绘制进度文字
4. 绘制 360 急救箱（这个真的需要吗）

显然，我们需要用 canvas 进行绘制（我不习惯用 pixi，所以没用它）。而首先，我们需要加载这几个用到的图片。那么我们就需要写一个加载系统，用来加载需要的资源。那么我们就先写一个加载类出来。首先列出来一个加载类需要的一些基础功能：

### 加载类

-   添加加载任务
-   获取加载进度，但理论上不能从外部设置，因此需要用 setter 和 getter
-   绑定加载进度的数值（由于使用了 vue，因此可以直接绑定到一个响应式变量上）
-   执行加载任务
-   监听加载是否完成

下面我们需要设计加载任务类。加载任务类应该有以下几个功能：

-   设置加载时执行的函数，或者是设置加载的地址，这里我们选择前者
-   监听任务的加载进度
-   监听任务是否加载完成
-   执行加载任务

列出所有功能后我们就可以写出 api 了。
